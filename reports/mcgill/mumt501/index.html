<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.3.0 for Hugo"><meta name=author content="Néstor Nápoles López"><meta name=description content="One of the barberpole phasing and flanging illusions described in Equeda et al. (2015)."><link rel=alternate hreflang=en-us href=/reports/mcgill/mumt501/><link rel=preconnect href=https://fonts.gstatic.com crossorigin><meta name=theme-color content="#1565c0"><script src=/js/mathjax-config.js></script><link rel=stylesheet href=/css/vendor-bundle.min.f1ecf783c14edc00c9320c205831ad8e.css media=print onload="this.media='all'"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin=anonymous media=print onload="this.media='all'"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css crossorigin=anonymous title=hl-light media=print onload="this.media='all'"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css crossorigin=anonymous title=hl-dark media=print onload="this.media='all'" disabled><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js integrity crossorigin=anonymous async></script><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload="this.media='all'"><link rel=stylesheet href=/css/wowchemy.c4d4d0fe4a8128c673e97327869a0f76.css><script async src="https://www.googletagmanager.com/gtag/js?id=UA-127095189-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}function trackOutboundLink(a,b){gtag('event','click',{event_category:'outbound',event_label:a,transport_type:'beacon',event_callback:function(){b!=='_blank'&&(document.location=a)}}),console.debug("Outbound link clicked: "+a)}function onClickCallback(a){if(a.target.tagName!=='A'||a.target.host===window.location.host)return;trackOutboundLink(a.target,a.target.getAttribute('target'))}gtag('js',new Date),gtag('config','UA-127095189-1',{}),gtag('set',{cookie_flags:'SameSite=None;Secure'}),document.addEventListener('click',onClickCallback,!1)</script><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu03a8b75004573f102e451e8733e2a105_6045_32x32_fill_lanczos_center_2.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu03a8b75004573f102e451e8733e2a105_6045_180x180_fill_lanczos_center_2.png><link rel=canonical href=/reports/mcgill/mumt501/><meta property="twitter:card" content="summary"><meta property="og:site_name" content="Néstor Nápoles López"><meta property="og:url" content="/reports/mcgill/mumt501/"><meta property="og:title" content="MUMT 501: Barberpole Phasing and Flanging Illusions | Néstor Nápoles López"><meta property="og:description" content="One of the barberpole phasing and flanging illusions described in Equeda et al. (2015)."><meta property="og:image" content="/media/icon_hu03a8b75004573f102e451e8733e2a105_6045_512x512_fill_lanczos_center_2.png"><meta property="twitter:image" content="/media/icon_hu03a8b75004573f102e451e8733e2a105_6045_512x512_fill_lanczos_center_2.png"><meta property="og:locale" content="en-us"><meta property="article:modified_time" content="2025-09-18T21:03:04-04:00"><title>MUMT 501: Barberpole Phasing and Flanging Illusions | Néstor Nápoles López</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=1af6f1e62d5870f229bc21a6311d8856><script src=/js/wowchemy-init.min.bb9394ade3949908af8ac334e87943b6.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=Close><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control aria-label=Search...></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><div class=page-header><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Néstor Nápoles López</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Néstor Nápoles López</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/#about><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/publication/><span>Publications</span></a></li><li class=nav-item><a class=nav-link href=/project/><span>Code</span></a></li><li class=nav-item><a class=nav-link href=/post/><span>Posts</span></a></li><li class=nav-item><a class="nav-link active" href=/reports/><span>Coursework</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a></li><li class=nav-item><a class="nav-link js-set-theme-dark" href=# aria-label="Display preferences"><i class="fas fa-moon" aria-hidden=true></i></a></li></ul></div></nav></div><div class=page-body><div class="container-fluid docs"><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 docs-sidebar"><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation"><div class=d-flex><span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">McGill Coursework</span>
<span><i class="fas fa-chevron-down"></i></span></div></button>
<button class="form-control sidebar-search js-search d-none d-md-flex">
<i class="fas fa-search pr-2"></i>
<span class=sidebar-search-text>Search...</span>
<span class=sidebar-search-shortcut>/</span></button></form><nav class="collapse docs-links" id=docs-nav><ul class="nav docs-sidenav"><li><a href=/reports/><i class="fas fa-arrow-left pr-1"></i>Coursework</a></li></ul><div class=docs-toc-item><a class=docs-toc-link href=/reports/mcgill/>McGill Coursework</a><ul class="nav docs-sidenav"><li class=active><a href=/reports/mcgill/mumt501/>MUMT 501: Barberpole Phasing and Flanging Illusions</a></li><li><a href=/reports/mcgill/mumt615/>MUMT 615: Melodic Tension Experiment</a></li><li><a href=/reports/mcgill/mumt616/>MUMT 616: Inharmonicity</a></li><li><a href=/reports/mcgill/mumt618/>MUMT 618: Implementation of Boss DS-1</a></li><li><a href=/reports/mcgill/mumt620/>MUMT 620: Cadence Game</a></li><li><a href=/reports/mcgill/mumt621/>MUMT 621: Hidden Markov Model for Symbolic Key Detection</a></li><li><a href=/reports/mcgill/muth251/>MUTH 251: Essay on Brahms Intermezzo Op.118 No.2</a></li></ul></div></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>Contents</a></li></ul><nav id=TableOfContents><ul><li><a href=#abstract>Abstract</a></li><li><a href=#introduction>Introduction</a></li><li><a href=#cascaded-time-varying-notch-filters>Cascaded Time-Varying Notch Filters</a></li><li><a href=#synchronized-dual-flanger>Synchronized Dual Flanger</a></li><li><a href=#single-sideband-modulation>Single-Sideband Modulation</a></li><li><a href=#implementation-of-the-cascaded-time-varying-notch-filters>Implementation of the cascaded time-varying notch-filters</a></li><li><a href=#conclusions>Conclusions</a></li></ul></nav></div><main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role=main><article class=article><div class=docs-article-container><nav class="d-none d-md-flex" aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=/>Home</a></li><li class=breadcrumb-item><a href=/reports/>Coursework</a></li><li class=breadcrumb-item><a href=/reports/mcgill/>McGill Coursework</a></li><li class="breadcrumb-item active" aria-current=page>MUMT 501: Barberpole Phasing and Flanging Illusions</li></ol></nav><h1>MUMT 501: Barberpole Phasing and Flanging Illusions</h1><div class=article-style><p>One of the barberpole phasing and flanging illusions described in Equeda et al. (2015).</p><h2 id=abstract>Abstract</h2><p>During the course <a href=https://www.mcgill.ca/study/2021-2022/courses/mumt-501 target=_blank rel=noopener>MUMT 501: Digital Audio Signal Processing</a>, I implemented one of the barberpole phasing and flanging illusions discussed in a paper by <a href=https://research.aalto.fi/en/publications/barberpole-phasing-and-flanging-illusions target=_blank rel=noopener>Esqueda et al. (2015)</a>. The paper write-up can also be accessed in <a href=/media/mumt501/mumt501_finalproject.pdf>PDF</a> form. The slides of the final presentation I made can be accessed <a href=/media/mumt501/mumt501_slides.pdf>here</a>.</p><h2 id=introduction>Introduction</h2><p>In his work of additive synthesis, Shepard introduced an infinitely
ascending chromatic scale.</p><figure id=figure-an-infinitely-ascending-chromatic-scale-as-presented-by-shepard><div class="d-flex justify-content-center"><div class=w-100><img alt="An infinitely ascending chromatic scale as presented by Shepard" srcset="/media/mumt501/shepard_notation_hu302ddc6d558f40ac2321e2aa0c9a56c4_29700_0484974840bc5a93a8cd81f0d01c3191.png 400w,
/media/mumt501/shepard_notation_hu302ddc6d558f40ac2321e2aa0c9a56c4_29700_5b4d09936d0e7921b3a97549e95d5907.png 760w,
/media/mumt501/shepard_notation_hu302ddc6d558f40ac2321e2aa0c9a56c4_29700_1200x1200_fit_lanczos_2.png 1200w" src=/media/mumt501/shepard_notation_hu302ddc6d558f40ac2321e2aa0c9a56c4_29700_0484974840bc5a93a8cd81f0d01c3191.png width=760 height=136 loading=lazy data-zoomable></div></div><figcaption data-pre=Figure&nbsp; data-post=:&nbsp; class=numbered>An infinitely ascending chromatic scale as presented by Shepard</figcaption></figure><p>This auditory illusion resembles some similarity to the effect caused by
barber-poles in american and british barber shops. In the case of the
barber-poles, one image with colored stripes in diagonal is attached to
a rotating cylinder and presented over and over in circles. The
interesting thing about this process is that the cycle is difficult to
perceive, and therefore, creates the illusion of the stripes ascending
forever.</p><p>Similarly, the auditory illusion proposed by Shepard is nothing but an
analogy in the auditory domain, presenting a cycle of raising harmonics
that repeats every octave.</p><p>In order to achieve this auditory illusion, we could summarize the steps
proposed by Shepard as following:</p><ol><li><p>Computing several harmonics <em>one octave apart</em> from each other</p></li><li><p>The harmonics in the middle must be <em>louder</em> than the ones at the
beginning or end of the frequency spectrum</p></li><li><p>We need to change the gain of each harmonic as time goes on, for
example, using some spectral envelope</p></li></ol><p>Shepard achieves the change of gain for each harmonic by using a
raised-cosine spectral envelope.</p><figure id=figure-a-time-varying-spectral-envelope-used-to-create-the-illusion-of-the-infinitely-ascending-chromatic-scale-as-presented-by-shepard><div class="d-flex justify-content-center"><div class=w-100><img alt="A time-varying spectral envelope used to create the illusion of the infinitely ascending chromatic scale, as presented by Shepard" srcset="/media/mumt501/shepard_envelope_hu07327376619e7ae317b4a27b40831589_13997_c20ab8af18182199154d856e16b3c0b1.png 400w,
/media/mumt501/shepard_envelope_hu07327376619e7ae317b4a27b40831589_13997_e98acbac6abbf2d0b1d398dc9b4b5e49.png 760w,
/media/mumt501/shepard_envelope_hu07327376619e7ae317b4a27b40831589_13997_1200x1200_fit_lanczos_2.png 1200w" src=/media/mumt501/shepard_envelope_hu07327376619e7ae317b4a27b40831589_13997_c20ab8af18182199154d856e16b3c0b1.png width=598 height=377 loading=lazy data-zoomable></div></div><figcaption data-pre=Figure&nbsp; data-post=:&nbsp; class=numbered>A time-varying spectral envelope used to create the illusion of the infinitely ascending chromatic scale, as presented by Shepard</figcaption></figure><p>It is mainly this idea of the raised-cosine spectral envelope that has
been preserved and reformulated in the audio effects proposed by
Esqueda, Välimäki, and Parker. This type of effects have been called
<em>barber-pole</em> flanging and phasing illusions, in accordance to the
similarity to the barber-poles, mentioned before in the introduction.</p><p>Esqueda, Välimäki, and Parker present three different ideas for
implementing barber-pole phasing and flanging audio effects: A network
of cascaded time-varying notch filters, a synchronized dual flanger, and
a single-sideband modulation filter.</p><p>In the following sections of this paper, I will briefly introduce the
concept of each of these filters proposed by Esqueda, Välimäki, and
Parker. Then, in the following section I am going to provide my
experience implementing one of them, the network of cascaded
time-varying notch filters.</p><h2 id=cascaded-time-varying-notch-filters>Cascaded Time-Varying Notch Filters</h2><p>In the original proposal by Shepard, the methodology considers the
creation of the auditory illusion by means of the additive synthesis of
several harmonics, which are one octave apart, and whose gain is shaped
by the raised-cosine spectral envelope.</p><p>This and the other audio effects, however, are dealing with a different
problem, which involves not the attempt to <em>synthesize</em> the illusion
from scratch, but instead, having an input signal and filtering it in
some way so the illusion emerges from the content of the signal itself.</p><p>Phasers and flangers work by creating sweeping <em>notches</em> in the spectrum
of the original signal, these are the selected mechanisms by Esqueda,
Välimäki, and Parker to create the barber-pole illusions.</p><figure id=figure-the-magnitude-response-of-a-cascaded-network-of-notch-filters-as-presented-by-esqueda-välimäki-and-parker><div class="d-flex justify-content-center"><div class=w-100><img alt="The magnitude response of a cascaded network of notch-filters as presented by Esqueda, Välimäki, and Parker" srcset="/media/mumt501/esqueda_magnituderesponse_hu44f3d9801c58f4062178445beb00d0b1_13799_8904aa140200f7f62a721ad0ecdc8514.png 400w,
/media/mumt501/esqueda_magnituderesponse_hu44f3d9801c58f4062178445beb00d0b1_13799_f235c4d7cb0ce5bdb797b31d55cfc42f.png 760w,
/media/mumt501/esqueda_magnituderesponse_hu44f3d9801c58f4062178445beb00d0b1_13799_1200x1200_fit_lanczos_2.png 1200w" src=/media/mumt501/esqueda_magnituderesponse_hu44f3d9801c58f4062178445beb00d0b1_13799_8904aa140200f7f62a721ad0ecdc8514.png width=453 height=357 loading=lazy data-zoomable></div></div><figcaption data-pre=Figure&nbsp; data-post=:&nbsp; class=numbered>The magnitude response of a cascaded network of notch-filters as presented by Esqueda, Välimäki, and Parker</figcaption></figure><p>The magnitude of a network of cascaded notch-filters is presented.</p><p>Each notch in the magnitude response represents the contribution of a
different notch-filter.</p><p>In general, this method of generating the auditory illusion is the one
that feels the closest to the original proposal by Shepard. For
Shepard, each harmonic represented an additional element in the chain of
additive synthesis. By contrast, in this audio effect each notch-filter
is an additional element in the network that shapes the spectrum of the
original signal so that the barber-pole illusion emerges.</p><p>The level of gain of each notch-filter, in this case attenuation, is
also controlled by a raised-cosine envelope, and time-varying for every
sample of the signal.</p><h2 id=synchronized-dual-flanger>Synchronized Dual Flanger</h2><p>The second effect proposed by Esqueda, Välimäki, and Parker is a dual
flanger.</p><p>The design of the system starts as a single flanger. The first
interesting characteristic of this flanger is the decision of using a
sawtooth waves as the Low-Frequency Oscillator (LFO) that modulates the
gain of the delayed signal, as well as another sawtooth wave that
modulates the length of the delay.</p><p>The motivation for using a sawtooth LFO is simple and elegant, it
provides an <em>unidirectional</em> growth over time that abruptly restarts for
the beginning of the next cycle. The auditory illusion requires that the
sweeping of the notches moves in the same direction for the entire
cycle, the sawtooth LFO provides exactly that.</p><p>One drawback introduced by this approach is the abrupt interruption
introduced by restarting the cycle from one instant to another, which
can give away the cyclic behavior of the system, and which is enemy to
the purpose of creating the auditory illusion. In order to soften the
transition between one cycle and another, the second flanger is added.
Hence, the dual flanger system.</p><p>The second flanger is an identical copy of the first flanger, it also
has a sawtooth LFO modulating the delay range and gain of the flanger,
the main difference is that both LFOs are in a $\frac{pi}{2}$ phase
with respect to their corresponding LFOs in the first flanger.</p><figure id=figure-the-phase-relationship-between-the-four-lfos-involved-in-the-dual-flanger-system-as-presented-by-esqueda-välimäki-and-parker><div class="d-flex justify-content-center"><div class=w-100><img alt="The phase relationship between the four LFOs involved in the dual flanger system as presented by Esqueda, Välimäki, and Parker" srcset="/media/mumt501/esqueda_flangerphase_hu80487b5d46a6fa736041f7509a5f4f29_19109_8158cdca9031a5414b99cfb450705576.png 400w,
/media/mumt501/esqueda_flangerphase_hu80487b5d46a6fa736041f7509a5f4f29_19109_13424c9c75ebf59c406cd55d216f6c94.png 760w,
/media/mumt501/esqueda_flangerphase_hu80487b5d46a6fa736041f7509a5f4f29_19109_1200x1200_fit_lanczos_2.png 1200w" src=/media/mumt501/esqueda_flangerphase_hu80487b5d46a6fa736041f7509a5f4f29_19109_8158cdca9031a5414b99cfb450705576.png width=432 height=340 loading=lazy data-zoomable></div></div><figcaption data-pre=Figure&nbsp; data-post=:&nbsp; class=numbered>The phase relationship between the four LFOs involved in the dual flanger system as presented by Esqueda, Välimäki, and Parker</figcaption></figure><p>Figure 4 shows the phase relationship between the two flangers in the dual-flanger system.</p><h2 id=single-sideband-modulation>Single-Sideband Modulation</h2><p>The third method presented by Esqueda, Välimäki, and Parker consists of
a system based on the combination of a signal and a frequency-shifted
version of the same signal (single-sideband modulation).</p><p>Three main important considerations have to be addressed in the method
proposed by Esqueda, Välimäki, and Parker. The first consideration is
that the frequency-shifted copy of the signal should be added to the
original signal only after delaying it for a short period. It is the
short delay that generates the notches in the spectrum of the output
signal of the system.</p><p>The second consideration is that it is necessary to have linearity
between the frequency shifter and the delay given to the modulated
signal. Once this two considerations are met, the system will produce
notches that are linearly distributed across the spectrum and that sweep
in the same direction.</p><p>Since the notches produced by the system are linearly distributed, this
does not favor the emergence of the barber-pole illusion. In order for
this to happen, the notches need to be one octave apart from each other,
as in the method by Shepard.</p><p>The third consideration deals with this problem, Esqueda, Välimäki, and
Parker suggest replacing the delay line of the system for a chain of
first-order all-pass filters acting as an spectral delay.</p><p>With this final modification, the system is able to produce sweeping
notches that are one octave from each other provided that the settings
on each of the all-pass filters are accurately optimized to meet the
desired group-delay curve.</p><h2 id=implementation-of-the-cascaded-time-varying-notch-filters>Implementation of the cascaded time-varying notch-filters</h2><p>The description of the systems presented by Esqueda, Välimäki, and
Parker is informative regarding the methodologies that should be
followed to accomplish an implementation of each of the systems.</p><p>Here we follow the methodologies proposed for the first system, the
network of cascaded notch-filters, to implement a prototype of the audio
effect in MATLAB.</p><p>The code of the implementation is given as an accompanying resource to
this paper, the code consists of several functions that compute all of
the parameters required for the system to operate on any given input
signal. The accompanying implementation also provides two main scripts,
one that provides an entry-point for the filter, which should be called
to process an input signal, furthermore, another script tests and makes
use of this entry-point with a white-noise signal and a combination of
parameters that successfully create a barber-pole auditory illusion.</p><p>The first step in the process of implementing this audio effect is to
separate the global parameters of the system from the time-varying
parameters, i.e., the parameters that should be computed every
short-time (in practice, every sample) in which the filter is operating.</p><p>This division between global and time-varying parameters is not given by
the original proposal of Esqueda, Välimäki, and Parker. Therefore, it
represents an interpretation of the parameters and workflow of the
original methodology that must be made in order to effectively implement
a prototype of the working system.</p><p>The global parameters of the audio effect are the following:</p><ul><li><p>$M$: The number of notch-filters in the cascade</p></li><li><p>$F_s$: The sampling rate of the system</p></li><li><p>$K$: The number of frequencies per cycle. Given by
$K = \text{floor}(F_s/p)$</p></li><li><p>$Q$: A control of the bandwidth of the notch-filters</p></li><li><p>$p$: The repetition rate of the cycle (how many times is the
system reaching an octave every second), in Hertz</p></li><li><p>$L_{min}$: Minimum loudness level, in decibels</p></li><li><p>$L_{max}$: Maximum loudness level, in decibels</p></li></ul><p>The time-varying parameters of the audio effect are the following:</p><ul><li><p>$f_c(m,k)$: Center frequency of the $m^{th}$ filter in the
$k^{th}$ frequency index of the cycle</p></li><li><p>$L_c(m,k)$: Loudness of the $k^{th}$ frequency of the $m^{th}$
filter, in decibels</p></li><li><p>$G$: The normalized version of gain $L_c$, in the range
$[0,1]$</p></li><li><p>$\beta$: A factor that involves the bandwidth and the gain at the
bandwidth, used to compute the coefficients of the notch-filters</p></li></ul><p>Once the most important parameters of the system have been defined and
classified accordingly, the next step is to define the workflow of the
system, especially for the time-varying part of the system which is the
most complicated to implement, as it involves the computation of the
coefficients for all of the filters involved in the network.</p><p>Given that the parameter $K$ dictates the number of frequencies that
have to be computed every cycle, this parameter defines the length of
the short-time sections of the signal that have to be processed by the
system. In fact, using the definition provided by Esqueda, Välimäki,
and Parker for computing the value of $K$, we can observe that it is
equivalent to <em>the number of samples that exist in one cycle</em>. This
means that there is a relationship of one sample for one frequency in
every case, for any sampling rate or repetition rate of the system. At
this point, we can safely assume that our implementation of the audio
effect has to effectively compute a new set of notch-filters for every
sample of the input signal.</p><p>The implementation that we followed, considers then, that the global
parameters will be provided by the user to the system. One exception are
the global parameters which can be obtained from other global parameters
(e.g., $K$), these are not required from the user and are computed
internally instead.</p><p>Once the global parameters are present in the system, we then start
processing the signal.</p><p>The methodology from Esqueda, Välimäki, and Parker provides the
transfer function used to compute each of the notch-filters of the
system.</p><p>$$H(z) =
\frac{
\big(
\frac{
1 + g \beta
}{
1 + \beta
}
\big) -
2 \big(
\frac{
\cos(
\frac{
2 \pi f_c
}{
F_s
}
)
}{
1 + \beta
}
\big) z^{-1} +
\big(
\frac{
1 - G \beta
}{
1 + \beta
}
\big) z^{-2}
}{
1 -
2 \big(
\frac{
\cos(
\frac{
2 \pi f_c
}{
F_s
}
)
}{
1 + \beta
}
\big) z^{-1} +
\big(
\frac{
1 - \beta
}{
1 + \beta
}
\big) z^{-2}
}
$$</p><p>The most efficient way to compute the network of cascaded notch-filters
would be to anticipate the system by multiplying the transfer function
of a network of notch-filters to get one resulting system and use this
system to filter the input signal, however, since the number of
notch-filters in our network is an unknown parameter, $M$, controlled
by the user, it is not easy to come with a strategy to pre-compute all
the possible numbers of notch-filters in the network and their
combinations with different parameters, such as the rate of the cycle of
the audio effect.</p><p>Therefore, I have decided that it is probably an easier strategy to use
this transfer function to go back to the difference equation of the
system, and compute the pertinent values of the coefficients of the
system <em>as they are needed</em>.</p><p>The difference equation of a notch-filter is the following:</p><p>$$y[n] = b_0 x[n] - b_1 x[n-1] + b_2 x[n-2] + a_1 y[n-1] - a_2 y[n-2]$$</p><p>Where the coefficients of the system correspond to</p><p>$$b_0 = \frac{
1 + G \beta
}{
1 + \beta
}$$</p><p>$$b_1 =
\frac{
2
\cos(
\frac{
2 \pi f_c
}{
F_s
})
}{
1 + \beta
}$$</p><p>$$b_2 = \frac{
1 - G \beta
}{
1 + \beta
}$$</p><p>$$a_1 = b_1$$</p><p>$$a_2 = \frac{
1 - \beta
}{
1 + \beta
}$$</p><p>The final implementation consists then of a delay-line of second order
which filters the input signal through a cascade of $M$ notch-filters.
The coefficients of the notch-filters are computed for every sample,
according to the properties of each notch-filter, namely, their center
frequency $f_c$ and the attenuation computed for that center frequency
$(L_c, G)$.</p><p>The implementation was done in Matlab, and all the source code is
available <a href=/media/mumt501/barberpole.zip>here</a>.</p><p>As an example, here is an audio input to the system and what it comes out.</p><p>Input [<a href=/media/mumt501/input.wav>wav</a>]</p><audio controls><source src=/media/mumt501/input.wav type=audio/wav></audio><p>Output [<a href=/media/mumt501/output.wav>wav</a>]
<audio controls><source src=/media/mumt501/output.wav type=audio/wav></audio></p><h2 id=conclusions>Conclusions</h2><p>In this paper, I outline the implementation of a cascaded notch-filter
system to create auditory illusions from an input signal. The reference
methodology by Esqueda, Välimäki, and Parker was very informative
about the parameters, formulas and methodologies used to test the filter
and generate the sound samples and the plots presented in their paper.
The implementation proposed here used the transfer function presented in
the reference methodology and used it to get the difference equation of
a notch-filter, computing its parameters for every sample and using
those coefficients to filter the input signal through a delay-line of
second order.</p></div><div class=article-widget><div class=post-nav><div class=post-nav-item><div class=meta-nav>Next</div><a href=/reports/mcgill/mumt615/ rel=prev>MUMT 615: Melodic Tension Experiment</a></div></div></div></div><div class=body-footer><p>Last updated on Sep 18, 2025</p></div></article><footer class=site-footer><p class=powered-by>© 2025 Néstor Nápoles López</p><p class=powered-by>Website template based on George Cushen&rsquo;s <a href="https://wowchemy.com/?utm_campaign=poweredby" target=_blank rel=noopener>Wowchemy</a>.</p></footer></main></div></div></div><div class=page-footer></div><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span></button></div><div class=modal-body><pre><code class="tex hljs"></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i> Copy</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i> Download</a><div id=modal-error></div></div></div></div></div><script src=/js/vendor-bundle.min.b73dfaac3b6499dc997741748a7c3fe2.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/matlab.min.js crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/python.min.js crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.2/anchor.min.js integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin=anonymous></script><script>anchors.add()</script><script id=search-hit-fuse-template type=text/x-template>
        <div class="search-hit" id="summary-{{key}}">
          <div class="search-hit-content">
            <div class="search-hit-name">
              <a href="{{relpermalink}}">{{title}}</a>
              <div class="article-metadata search-hit-type">{{type}}</div>
              <p class="search-hit-description">{{snippet}}</p>
            </div>
          </div>
        </div>
      </script><script src=https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin=anonymous></script><script src=/en/js/wowchemy.min.d2b0f682c23051fbfdb3b131afcba4c3.js></script></body></html>