<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.3.0 for Hugo"><meta name=author content="Néstor Nápoles López"><meta name=description content="I recently changed my laptop. I thought a long journey awaited for me making this relatively new laptop work with Linux. To my surprise, it wasn't too difficult. Props on MSI for making Linux-friendly hardware! Here are the steps to install the graphics driver and get this laptop running Tensorflow 2 on the RTX2070 card."><link rel=alternate hreflang=en-us href=/post/msigl65/><link rel=preconnect href=https://fonts.gstatic.com crossorigin><meta name=theme-color content="#1565c0"><link rel=stylesheet href=/css/vendor-bundle.min.f1ecf783c14edc00c9320c205831ad8e.css media=print onload="this.media='all'"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin=anonymous media=print onload="this.media='all'"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css crossorigin=anonymous title=hl-light media=print onload="this.media='all'"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css crossorigin=anonymous title=hl-dark media=print onload="this.media='all'" disabled><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload="this.media='all'"><link rel=stylesheet href=/css/wowchemy.c4d4d0fe4a8128c673e97327869a0f76.css><script async src="https://www.googletagmanager.com/gtag/js?id=UA-127095189-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}function trackOutboundLink(a,b){gtag('event','click',{event_category:'outbound',event_label:a,transport_type:'beacon',event_callback:function(){b!=='_blank'&&(document.location=a)}}),console.debug("Outbound link clicked: "+a)}function onClickCallback(a){if(a.target.tagName!=='A'||a.target.host===window.location.host)return;trackOutboundLink(a.target,a.target.getAttribute('target'))}gtag('js',new Date),gtag('config','UA-127095189-1',{}),gtag('set',{cookie_flags:'SameSite=None;Secure'}),document.addEventListener('click',onClickCallback,!1)</script><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu03a8b75004573f102e451e8733e2a105_6045_32x32_fill_lanczos_center_2.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu03a8b75004573f102e451e8733e2a105_6045_180x180_fill_lanczos_center_2.png><link rel=canonical href=/post/msigl65/><meta property="twitter:card" content="summary_large_image"><meta property="og:site_name" content="Néstor Nápoles López"><meta property="og:url" content="/post/msigl65/"><meta property="og:title" content="Linux with Tensorflow in MSI GL65 (with RTX2070) | Néstor Nápoles López"><meta property="og:description" content="I recently changed my laptop. I thought a long journey awaited for me making this relatively new laptop work with Linux. To my surprise, it wasn't too difficult. Props on MSI for making Linux-friendly hardware! Here are the steps to install the graphics driver and get this laptop running Tensorflow 2 on the RTX2070 card."><meta property="og:image" content="/post/msigl65/featured.png"><meta property="twitter:image" content="/post/msigl65/featured.png"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2016-04-20T00:00:00+00:00"><meta property="article:modified_time" content="2021-08-31T12:07:44-04:00"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"/post/msigl65/"},"headline":"Linux with Tensorflow in MSI GL65 (with RTX2070)","image":["/post/msigl65/featured.png"],"datePublished":"2016-04-20T00:00:00Z","dateModified":"2021-08-31T12:07:44-04:00","author":{"@type":"Person","name":"Néstor Nápoles López"},"publisher":{"@type":"Organization","name":"Néstor Nápoles López","logo":{"@type":"ImageObject","url":"/media/icon_hu03a8b75004573f102e451e8733e2a105_6045_192x192_fill_lanczos_center_2.png"}},"description":"I recently changed my laptop. I thought a long journey awaited for me making this relatively new laptop work with Linux. To my surprise, it wasn't too difficult. Props on MSI for making Linux-friendly hardware! Here are the steps to install the graphics driver and get this laptop running Tensorflow 2 on the RTX2070 card."}</script><title>Linux with Tensorflow in MSI GL65 (with RTX2070) | Néstor Nápoles López</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=e1339d1a5c4a018d445c48f9d9af690d><script src=/js/wowchemy-init.min.bb9394ade3949908af8ac334e87943b6.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=Close><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control aria-label=Search...></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><div class=page-header><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Néstor Nápoles López</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Néstor Nápoles López</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/#about><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/publication/><span>Publications</span></a></li><li class=nav-item><a class=nav-link href=/project/><span>Code</span></a></li><li class=nav-item><a class="nav-link active" href=/post/><span>Posts</span></a></li><li class=nav-item><a class=nav-link href=/reports/><span>Coursework</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a></li><li class=nav-item><a class="nav-link js-set-theme-dark" href=# aria-label="Display preferences"><i class="fas fa-moon" aria-hidden=true></i></a></li></ul></div></nav></div><div class=page-body><article class=article><div class="article-container pt-3"><h1>Linux with Tensorflow in MSI GL65 (with RTX2070)</h1><p class=page-subtitle>All the necessary steps for a Deep Learning prototyping station</p><div class=article-metadata><div><span class=author-highlighted>Néstor Nápoles López</span></div><span class=article-date>Last updated on
Aug 31, 2021</span>
<span class=middot-divider></span><span class=article-reading-time>4 min read</span></div></div><div class="article-header container featured-image-wrapper mt-4 mb-4" style=max-width:907px;max-height:593px><div style=position:relative><img src=/post/msigl65/featured.png alt class=featured-image>
<span class=article-header-caption>Image credit: msi.com</span></div></div><div class=article-container><div class=article-style><p>I have been a linux user for a few years now.</p><p>I have also been interested in playing games in my computer (although being a gamer nowadays feels like a full-time job, so I don&rsquo;t consider myself a hardcore gamer).</p><p>I often run a dual boot system, doing most of my daily chores on Linux, and playing during the weekends on my MS Windows partition.</p><p>To my surprise, installing a linux partition in this particular laptop was straightforward. No special settings on the bootloader, no special proprietary drivers for my WiFi. It just worked out of the box after I booted and installed a live usb flash drive.</p><p>Of course, the proprietary graphics driver, CUDA, and cuDNN have to be installed independently after the fresh OS install if you are interested in using the graphics card to train some deep learning models.</p><p>Those components are what I will be covering in this post.</p><p>I will also be assuming that you are running an Ubuntu 20.04 distro.</p><p>The steps should be fairly similar for other Debian-based distros.</p><h2 id=installing-proprietary-nvidia-drivers>Installing proprietary NVIDIA drivers</h2><p>You have a few options for installing the graphic drivers. If you don&rsquo;t feel like modding your default OS too much, I recommend you to simply install them from the <code>Additional Drivers</code> tab in your <code>Software & Updates</code> menu in Ubuntu.</p><p>Launch the <code>Activities</code> menu and type <code>Additional Drivers</code></p><p>You should see the option for your NVIDIA RTX2070 there.</p><p>Install the latest version available and tested.</p><p>In my case, and at the time of this writing, that is <code>nvidia-driver-450</code>.</p><h2 id=installing-cuda>Installing CUDA</h2><p>Tensorflow works with CUDA v10.1.</p><p>The CUDA toolkit for v10.1 can be found in the package manager.</p><pre><code class=language-bash>sudo apt-get install nvidia-cuda-toolkit
</code></pre><p>Check the version</p><pre><code class=language-bash>$ nvcc --version
nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2019 NVIDIA Corporation
Built on Sun_Jul_28_19:07:16_PDT_2019
Cuda compilation tools, release 10.1, V10.1.243
</code></pre><p>If you are in <code>v10.1</code>, you are good to go.</p><h2 id=installing-cudnn>Installing cuDNN</h2><p>Tensorflow requires cuDNN v7.6.</p><p>You can obtain the library either as a <code>.deb</code> package or by downloading the zipped <code>.so</code> libraries.</p><p>At the time of this writing, the <code>.deb</code> package is only available for Ubuntu &lt;=18.04 and the folder structure differs from the folder structure of my cuda library installed from the package manager.</p><p>I suggest downloading the <code>.so</code> libraries.</p><p>You can either download the zipped files of <a href=https://developer.nvidia.com/compute/machine-learning/cudnn/secure/7.6.5.32/Production/10.1_20191031/cudnn-10.1-linux-x64-v7.6.5.32.tgz target=_blank rel=noopener>v7.6.5</a>, or browse the <a href=https://developer.nvidia.com/rdp/cudnn-archive target=_blank rel=noopener>archive</a>.</p><blockquote><p>Note that you need to make an account to download these zipped files from NVIDIA</p></blockquote><p>Uncompress the file somewhere in your file system</p><pre><code class=language-bash>$ tar xvf cudnn-10.1-linux-x64-v7.6.5.32.tgz 
</code></pre><p>That should generate a folder named <code>cuda</code> wherever you uncompressed it.</p><p>For your convenience, make a variable <code>CUDNNDIR</code> that points to wherever place you uncompressed the file in.</p><p>In my case, I uncompressed inside my <code>Download</code> folder, so this is how it looks</p><pre><code class=language-bash>$ CUDNNDIR=~/Downloads/cuda
</code></pre><p>This is the structure of my uncompressed file</p><pre><code class=language-bash>$ tree $CUDNNDIR

.
├── include
│   └── cudnn.h
├── lib64
│   ├── libcudnn.so -&gt; libcudnn.so.7
│   ├── libcudnn.so.7 -&gt; libcudnn.so.7.6.5
│   ├── libcudnn.so.7.6.5
│   └── libcudnn_static.a
└── NVIDIA_SLA_cuDNN_Support.txt
</code></pre><p>In my Ubuntu 20.04 and using the <code>nvidia-cuda-toolkit</code> package from aptitude, the library is installed here:</p><pre><code class=language-bash>CUDADIR=/lib/cuda
</code></pre><p>I also suggest making a variable that points to that place. Replace <code>/lib/cuda</code> with your location if that&rsquo;s not where the library was installed.</p><p>The structure of my <code>CUDADIR</code>:</p><pre><code class=language-bash>$ tree $CUDADIR

/lib/cuda
├── bin
├── include
├── lib64
├── nvvm
│   └── libdevice -&gt; ../../nvidia-cuda-toolkit/libdevice
└── version.txt
</code></pre><p>The <code>CUDADIR</code> is where we need to install the <code>cuDNN</code> library.</p><p>Installing, in this context, is basically copying the headers and shared library. Then, making these files available to external libraries like tensorflow.</p><p>Copy the headers</p><pre><code class=language-bash>sudo cp ${CUDNNDIR}/include/*.h ${CUDADIR}/include/
</code></pre><p>Copy the shared libraries</p><pre><code class=language-bash>sudo cp ${CUDNNDIR}/lib64/libcudnn* ${CUDADIR}/lib64
</code></pre><p>The file structure of the CUDA library should look something like this now</p><pre><code class=language-bash>/lib/cuda
├── bin
├── include
│   └── cudnn.h
├── lib64
│   ├── libcudnn.so
│   ├── libcudnn.so.7
│   ├── libcudnn.so.7.6.5
│   └── libcudnn_static.a
├── nvvm
│   └── libdevice -&gt; ../../nvidia-cuda-toolkit/libdevice
└── version.txt
</code></pre><p>Change permissions to the recently copied files</p><pre><code class=language-bash>sudo chmod a+r ${CUDADIR}/include/cudnn*.h ${CUDADIR}/lib64/libcudnn*
</code></pre><p>That installed cuDNN in your system.</p><p>At least in my case, these files are still not reachable by tensorflow. You can achieve that by exporting the path to your <code>LD_LIBRARY_PATH</code> variable.</p><pre><code class=language-bash>export LD_LIBRARY_PATH=${CUDADIR}/lib64:$LD_LIBRARY_PATH
</code></pre><p>Now check whether tensorflow 2 is able to see your gpu</p><pre><code class=language-python>$ python3
Python 3.8.5 (default, Jul 28 2020, 12:59:40) 
[GCC 9.3.0] on linux
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt; import tensorflow as tf
&gt;&gt;&gt; tf.config.list_physical_devices('GPU') 
[PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
</code></pre><p>If you get a non-empty list as the result of <code>list_physical_devices('GPU')</code>, that should be a good indicator.</p><p>The <code>export</code> instruction is not persistent and the changes will be lost after you close your terminal.</p><p>Make it permanent by adding it to your <code>~/.bashrc</code> file.</p><p>Putting new statements at the end of the file is usually the best practice.</p><p>When you do that, spell the <code>$CUDADIR</code> folder as an absolute path, do not use the <code>$CUDADIR</code> variable.</p><p>You should be all set. Try training something and check the console to corroborate it is doing it through your RTX2070.</p><p>Cheers.</p></div><div class=share-box aria-hidden=true><ul class=share><li><a href="https://twitter.com/intent/tweet?url=/post/msigl65/&text=Linux%20with%20Tensorflow%20in%20MSI%20GL65%20%28with%20RTX2070%29" target=_blank rel=noopener class=share-btn-twitter><i class="fab fa-twitter"></i></a></li><li><a href="https://www.facebook.com/sharer.php?u=/post/msigl65/&t=Linux%20with%20Tensorflow%20in%20MSI%20GL65%20%28with%20RTX2070%29" target=_blank rel=noopener class=share-btn-facebook><i class="fab fa-facebook"></i></a></li><li><a href="mailto:?subject=Linux%20with%20Tensorflow%20in%20MSI%20GL65%20%28with%20RTX2070%29&body=/post/msigl65/" target=_blank rel=noopener class=share-btn-email><i class="fas fa-envelope"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?url=/post/msigl65/&title=Linux%20with%20Tensorflow%20in%20MSI%20GL65%20%28with%20RTX2070%29" target=_blank rel=noopener class=share-btn-linkedin><i class="fab fa-linkedin-in"></i></a></li><li><a href="whatsapp://send?text=Linux%20with%20Tensorflow%20in%20MSI%20GL65%20%28with%20RTX2070%29%20/post/msigl65/" target=_blank rel=noopener class=share-btn-whatsapp><i class="fab fa-whatsapp"></i></a></li><li><a href="https://service.weibo.com/share/share.php?url=/post/msigl65/&title=Linux%20with%20Tensorflow%20in%20MSI%20GL65%20%28with%20RTX2070%29" target=_blank rel=noopener class=share-btn-weibo><i class="fab fa-weibo"></i></a></li></ul></div><div class="media author-card content-widget-hr"><a href=/><img class="avatar mr-3 avatar-circle" src=/authors/admin/avatar_hue8a5a4e87bd9cdc4f9052705d8c47a63_51674_270x270_fill_q75_lanczos_center.jpg alt="Néstor Nápoles López"></a><div class=media-body><h5 class=card-title><a href=/>Néstor Nápoles López</a></h5><h6 class=card-subtitle>PhD Candidate in Music Technology</h6><p class=card-text>I am interested in all of the ways in which modern technologies can help us to learn, understand, create, and enjoy music.</p><ul class=network-icon aria-hidden=true><li><a href=mailto:%6Ea%70%75%6c%65n%40%67m%61%69l%2E%63o%6D><i class="fas fa-envelope"></i></a></li><li><a href=https://twitter.com/napulen target=_blank rel=noopener><i class="fab fa-twitter"></i></a></li><li><a href="https://scholar.google.com/citations?user=flGxOu0AAAAJ&hl=en" target=_blank rel=noopener><i class="fas fa-graduation-cap"></i></a></li><li><a href=https://github.com/napulen target=_blank rel=noopener><i class="fab fa-github"></i></a></li><li><a href=https://www.linkedin.com/in/napulen target=_blank rel=noopener><i class="fab fa-linkedin"></i></a></li></ul></div></div></div></article></div><div class=page-footer><div class=container><footer class=site-footer><p class=powered-by>© 2021 Néstor Nápoles López</p><p class=powered-by>Website template based on George Cushen&rsquo;s <a href="https://wowchemy.com/?utm_campaign=poweredby" target=_blank rel=noopener>Wowchemy</a>.</p></footer></div></div><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span></button></div><div class=modal-body><pre><code class="tex hljs"></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i> Copy</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i> Download</a><div id=modal-error></div></div></div></div></div><script src=/js/vendor-bundle.min.b73dfaac3b6499dc997741748a7c3fe2.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/matlab.min.js crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/python.min.js crossorigin=anonymous></script><script id=search-hit-fuse-template type=text/x-template>
        <div class="search-hit" id="summary-{{key}}">
          <div class="search-hit-content">
            <div class="search-hit-name">
              <a href="{{relpermalink}}">{{title}}</a>
              <div class="article-metadata search-hit-type">{{type}}</div>
              <p class="search-hit-description">{{snippet}}</p>
            </div>
          </div>
        </div>
      </script><script src=https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin=anonymous></script><script src=/en/js/wowchemy.min.d2b0f682c23051fbfdb3b131afcba4c3.js></script></body></html>